{% extends "record_base_clean.html" %}

{% load static %}

{% block main_area %}

<form style="display:none;">
  {% csrf_token %}
</form>

<section class="record-wrap">

  <input type="hidden" id="ctx-rgs-dt" value="{{ request.session.rgs_dt }}">
  <input type="hidden" id="ctx-time-slot" value="{{ request.session.time_slot }}">

  <!-- 식단 기록 카드 -->
  <section class="panel">
    <div class="panel-head">
      <h2 class="panel-title">식단 기록</h2>
      {% load static %}

      <!-- ✅ 감정 기록에서 넘어온 컨텍스트(session) → JS가 읽기 위한 hidden -->
      <input type="hidden" id="ctx-rgs-dt" value="{{ request.session.rgs_dt }}">
      <input type="hidden" id="ctx-time-slot" value="{{ request.session.time_slot }}">
      <!-- DEBUG: {{ request.session.rgs_dt }} / {{ request.session.time_slot }} -->


      <a id="btn-camera" class="camera-btn" href="javascript:void(0)" aria-label="카메라">
        <img class="camera-ico" src="{% static 'record_img/dslr-camera.png' %}" alt="카메라">
      </a>
    </div>

    <!-- 최근 3개 끼니 카드 -->
    <div id="recent-cards" class="cards-3">
      <article class="meal-card empty">
        <div class="meal-card-img"></div>
        <div class="meal-card-text">아직 기록 전입니다.<br>기록을 남겨보세요!</div>
      </article>
      <article class="meal-card empty">
        <div class="meal-card-img"></div>
        <div class="meal-card-text">아직 기록 전입니다.<br>기록을 남겨보세요!</div>
      </article>
      <article class="meal-card empty">
        <div class="meal-card-img"></div>
        <div class="meal-card-text">아직 기록 전입니다.<br>기록을 남겨보세요!</div>
      </article>
    </div>

    <div class="recipe-row">
      <a id="btn-my-recipe" class="recipe-pill" href="#">나의 레시피 가져오기</a>
    </div>

    <div class="search-row">
      <input id="food-search-input" class="search-input" type="text" placeholder="검색 내용을 입력하세요.">
      <button id="food-search-btn" class="search-btn" type="button">Search</button>
    </div>

    <div id="selected-bar" class="selected-bar" aria-live="polite"></div>

    <div class="table-wrap">
      <table class="food-table">
        <thead>
          <tr>
            <th class="col-check">선택</th><th>제품명</th><th>칼로리</th><th>탄수화물</th><th>단백질</th><th>지방</th>
          </tr>
        </thead>
        <tbody id="record-items-tbody"></tbody>
      </table>
    </div>
  </section>

  <!-- 하단 버튼 -->
  <div class="bottom-actions">
    <button id="btn-prev" class="bottom-btn" type="button">이전</button>
    <button id="btn-save-meal" class="bottom-btn primary" type="button">저장</button>
  </div>

</section>

<script defer src="{% static 'js/record_state.js' %}"></script>
<script defer src="{% static 'js/record_food/food_search.js' %}"></script>
{% endblock %}
